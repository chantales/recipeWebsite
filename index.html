<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>french quiz!</title>
<style>
     #quizQuestionSpace {
           display: none;
     }


</style>
</head>
<body>
<h1>quiz to test your french skills!</h1>
     <div id="levelDiv">
           <button id="beginnerB">beginner level</button> <button id="advancedB">advanced level</button>
     </div>
     <div id="quizQuestionSpace">
           <h1 id="questionTracker"></h1>
           <h3 id="questionSlot"></h3>
           <input id="userInput" placeholder="enter answer here" type="text">
           <button id="guessB" onclick="guessAnswer()">guess answer</button>
     </div>
     <br>
     <h1 id="scoreSlot"></h1>
     <br>
    
<script type="module">
// Imports Firebase into code
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";


const firebaseConfig = {
     apiKey: "AIzaSyCr92M2VsECW-G6qFgFLehHNo7ApHEjRnw",
     authDomain: "leaderboardforfrench.firebaseapp.com",
     databaseURL: "https://leaderboardforfrench-default-rtdb.asia-southeast1.firebasedatabase.app",
     projectId: "leaderboardforfrench",
     storageBucket: "leaderboardforfrench.appspot.com",
     messagingSenderId: "800482061018",
     appId: "1:800482061018:web:3ad1c7179b02f8ca4e53e3"
};


// Initializes Firebase
const app = initializeApp(firebaseConfig);
import {getDatabase, set, get, ref, child}
from "https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js"




var quizQuestionSpace = document.getElementById("quizQuestionSpace");
var userInput = document.getElementById("userInput"); // pulls userInput
let quizIndex = 0; // sets quizIndex to 0 on page load
let score = 0; // sets score to 0 on page load
let currentQuestion, rightAnswer;


const quizLength = 7; // for easy adjustment of quiz length
const rightTime = 1000; // for easy adjustment of correct answer page holding time
const wrongTime = 2000; // for easy adjustment of incorrect answer page holding time
const rightAnswerCol = "rgb(128, 255, 128)"; // for easy adjustment + usage of the background colour that appears for correct answer
const wrongAnswerCol = "rgb(250, 100, 100)"; // for easy adjustment + usage of the background colour that appears for incorrect answer
const bgCol = "white"; // for easy adjustment + usage of the background colour


const dataB = getDatabase();
const beginnerQuestionLink = "easyQuizData/easyQuestions";
const advancedQuestionLink = "hardQuizData/hardQuestions";


let quizData = [];
let questionsDone = []; // place to keep all already done questions


beginnerB.addEventListener("click", beginnerQuestions); // on beginnerB button clicked, run the beginnerQuestions function
advancedB.addEventListener("click", advancedQuestions); // on advancedB button clicked, run the advancedQuestions function


// allows users to submit by pressing "enter". when the button is pressed, this function is called
userInput.addEventListener("keypress", function(event) { // when the key is pressed, the function will run. the event holds info about what triggered the function
     if (event.key === "Enter") { // if the enter button is pressed,
       event.preventDefault(); // cancel the original action that pressing enter would do
       document.getElementById("guessB").click(); // gets the guessB element and triggers a click of it
     }
   });


// function to pick a new random question, while also ensuring the question hasn't been done before
function selectRandomQ() {
     let randomIndex
     do {
           randomIndex = Math.floor(Math.random() * quizData.length); // randomises a number and assigns randomIndex to it
     } while (questionsDone.includes(randomIndex)) // do ^ while the questionsDone array searches for if the question is in itself
           // if quizData is empty, do not let quiz continue
           if(quizData.length === 0) {
                 alert("no questions avalible. please try again") // explains that the quiz cannot start yet
           } else {
                 questionsDone.push(randomIndex); // marks this question as done and puts it in questionsDone so there are no repeats
                 currentQuestion = quizData[randomIndex]; // makes current question a random question pulled from quizData


                 rightAnswer = currentQuestion["answer"].toLowerCase();  // stores the correct answer into rightAnswer in lowercase
                 questionSlot.textContent = currentQuestion["question"]; // displays the question on webpage
           }
}


// checks if the answer is correct or incorrect, indicating this with colours. also increases quizIndex as the user answers questions.
function guessAnswer() {
     const userInputsVal = userInput.value.trim().toLowerCase()


     // if the answer is correct, the screen will turn green and the score will increase by 1
     if (userInputsVal == rightAnswer) {
           document.body.style.backgroundColor = rightAnswerCol; // sets the background to rightAnswerCol
           guessB.style.display = "none"; // hides guessing button
           userInput.style.display = "none"; // hides input field
           score++; // increases score by 1
           quizIndex++; // increases quizIndex by 1
          
           // wait for rightTime no. of seconds before continuing quiz
           setTimeout(function() {
                 if (quizIndex < quizLength) {
                       document.body.style.backgroundColor = bgCol; // brings page back to defalut bg colour
                       guessB.style.display = "inline-block"; // brings back guessing button
                       userInput.style.display = "inline-block"; // brings back inputField
                       selectRandomQ(); // selects a new random question
                 } else {
                       endQuiz(); // if quizIndex has reached the quizLength, play endQuiz()
                 }
           }, rightTime);


     }


     // if there is no input, an alert will appear asking for input
     else if (userInputsVal == ''||userInputsVal == 'â€‹') {
           alert("please insert an answer")
     }


     // if answer is incorrect, the screen turns red and the next question will appear (no points added)
     else {
           document.body.style.backgroundColor = wrongAnswerCol;
           scoreSlot.textContent = rightAnswer; // displays correct answer
           guessB.style.display = "none"; // hides guessing button while displaying correct answer
           userInput.style.display = "none"; // hides input field while displaying correct answer
           quizIndex++; // increases quizIndex by 1


           // wait for wrongTime no. of seconds before continuing quiz
           setTimeout(function() {
                  // if quiz is finished, show the score and play the rankShow funtion
                 if (quizIndex < quizLength) {
                       selectRandomQ(); // calls function again to get a new question
                       scoreSlot.textContent = ''; // clears answer / score space
                       document.body.style.backgroundColor = bgCol;
                       guessB.style.display = "inline-block"; // brings back guessing button
                       userInput.style.display = "inline-block"; // brings back inputField
                 } else {
                       endQuiz();
                 }
           }, wrongTime)
     }
questionTracker.textContent = quizIndex + " / " + quizLength; // question tracker
userInput.value = ''; // clears user input field
};
window.guessAnswer = guessAnswer; // makes guessAnswer globally acessible (fixes firebase)


// when the quiz ends, the questions are hidden and the score is displayed
function endQuiz() {
     quizQuestionSpace.style.display = "none"; // hides questions
     scoreSlot.textContent = "your score is " + score; // displays score
     document.body.style.backgroundColor = bgCol; // sets background to default colour
}


// when the beginnerB button is pressed, it will hide the buttons and set loadQuestions to beginner questions
function beginnerQuestions() {
           levelDiv.style.display = "none"; // hides the difficulty buttons
           quizQuestionSpace.style.display = "block"; // displays the questions
           questionTracker.style.float = "right"; // displays the tracker
           loadQuestions(beginnerQuestionLink); // sets the path of loadQuestions to beginnerQuestionLink
};


// when the advancedB button is pressed, it will hide the buttons and set loadQuestions to advanced questions
function advancedQuestions() {
           levelDiv.style.display = "none"; // hides the difficulty buttons
           quizQuestionSpace.style.display = "block"; // displays the questions
           questionTracker.style.float = "right"; // displays the tracker
           loadQuestions(advancedQuestionLink); // sets the path of loadQuestions to advancedQuestionLink
};


// loads either the beginner or advanced questions from firebase and stores them in quizData
function loadQuestions(path) {
     const dataBref = ref(dataB, path); // creates a refrence to a specific location, specified by "path"
     get(dataBref) // retrieves the data from the location
     .then((snapshot)=>{
           if(snapshot.exists()){ // checks if it exists
                 quizData = snapshot.val(); // if it does, set quizData to the selected diffulty
                 selectRandomQ(); // select random question


                 // if quizData is empty, do not let quiz continue
                 if(quizData.length === 0) {
                       alert("no questions avalible. please try again") // explains that the quiz cannot start yet
                 }
           }
           else {
                 alert("please try again")
           }
     })
}
</script>
</body>
</html>







